@startuml Transaction List Flow
actor User as u
participant Frontend as fe
participant Gateway as gw
participant TransactionService as ts
participant WalletService as ws
participant UserService as us
participant IAMService as iam
database TransactionDB as tdb
database WalletDB as wdb
database UserDB as udb
database IAMDB as idb

u -> fe: Request transaction list
activate fe

' Get wallet code
fe -> gw: GET /api/v1/wallet/getWallet/{userId}
activate gw
gw -> ws: Forward request
activate ws
ws -> wdb: Query wallet
activate wdb
wdb --> ws: Return wallet
deactivate wdb
ws --> gw: Return WalletResponse
deactivate ws
gw --> fe: Return wallet info
deactivate gw

' Get transactions
fe -> gw: GET /transaction-list-by-user\n(with wallet code + filters)
activate gw
gw -> ts: Forward request
activate ts

' Get transaction data
ts -> tdb: Query transactions with pagination
activate tdb
tdb --> ts: Return transactions
deactivate tdb

loop for each transaction
    ' Get sender info
    ts -> ws: GET wallet/{senderWalletCode}
    activate ws
    ws -> wdb: Query sender wallet
    activate wdb
    wdb --> ws: Return wallet
    deactivate wdb
    ws --> ts: Return sender wallet info
    deactivate ws

    ' Get receiver info  
    ts -> ws: GET wallet/{receiverWalletCode}
    activate ws
    ws -> wdb: Query receiver wallet
    activate wdb
    wdb --> ws: Return wallet
    deactivate wdb
    ws --> ts: Return receiver wallet info
    deactivate ws

    ' Get user info
    ts -> us: GET user/{userId}
    activate us
    us -> udb: Query user profile
    activate udb
    udb --> us: Return profile
    deactivate udb
    us -> iam: GET role-status/{userId}
    activate iam
    iam -> idb: Query role/status
    activate idb
    idb --> iam: Return role/status
    deactivate idb
    iam --> us: Return user status/role
    deactivate iam
    us --> ts: Return user info
    deactivate us

    ts -> ts: Build TransactionResponse
end

ts --> gw: Return paginated TransactionResponse
deactivate ts
gw --> fe: Return response
deactivate gw

fe -> fe: Update UI state
fe --> u: Display transaction list
deactivate fe

@enduml